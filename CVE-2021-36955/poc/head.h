#pragma once
#ifndef HEAD_H
#define HEAD_H
#include <windows.h>
#include <stdio.h>
#include <clfsw32.h>
#include <ntstatus.h>
#include "ntos.h"

#define CLFS_TAG 0x73666C43 // 'CLFS'
#define KTHREAD_PREVIOUS_MODE_OFFSET 0x232

typedef struct _SYSTEM_BIGPOOL_ENTRY {
	union {
		PVOID VirtualAddress;
		ULONG_PTR NonPaged : 1;
	};
	SIZE_T SizeInBytes;
	union {
		UCHAR Tag[4];
		ULONG TagUlong;
	};
} SYSTEM_BIGPOOL_ENTRY, * PSYSTEM_BIGPOOL_ENTRY;

typedef struct _SYSTEM_BIGPOOL_INFORMATION {
	ULONG Count;
	SYSTEM_BIGPOOL_ENTRY AllocatedInfo[10000];
} SYSTEM_BIGPOOL_INFORMATION, * PSYSTEM_BIGPOOL_INFORMATION;


#endif // HEAD_H